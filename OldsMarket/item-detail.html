<!DOCTYPE html>
<html lang="en">

<head>

    <!--meta tags-->

    <meta charset="UTF-8">
    <meta name="description" content="Services Listing HTML5 CSS3 template">
    <meta name="keywords" content="HTML,CSS,XML,JavaScript, services, listing">
    <meta name="author" content="Ui-DesignLab">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--end meta tags-->
    <style>
        #btn{
            position: absolute;
            top: 40rem;
            width: 23rem;
            left: 5rem;
        }
    </style>

    <title>商品详情</title>
    <!--stylesheets-->
    <link rel="stylesheet" href="vendor/css/bootstrap.min.css">
    <link rel="stylesheet" href="vendor/css/animate.min.css">
    <link rel="stylesheet" href="vendor/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="vendor/OwlCarousel2-2.2.1/owl.carousel.min.css">
    <link rel="stylesheet" href="vendor/OwlCarousel2-2.2.1/owl.theme.green.min.css">
    <link rel="stylesheet" href="vendor/perfect-scrollbar/css/perfect-scrollbar.min.css">
    <link rel="stylesheet" href="css/app.css">
    <!--end stylesheets-->

    <!--google fonts-->
    <link
        href="https://fonts.googleapis.com/css?family=Cairo%7CNosifer%7CPoppins%7CQuicksand:700%7CRaleway%7CTangerine%7CHind+Vadodara"
        rel="stylesheet">
    <!--end google fonts-->
</head>

<body>



    <!--导航栏-->
    <nav class="site-top-nav">
        <div class="logo">
            <a href="index.html">
                <img src="img/logo.png" alt="">
                <strong>升龙二手物品交易平台</strong>
            </a>
        </div>
        <ul class="site-menu">
            <li>
                <a href="index.html">首页 <i class="fa fa-angle-down"></i></a>
            </li>
            <li>
                <a href="pricing.html">其他页面<i class="fa fa-angle-down"></i></a>
                <ul class="nav-dropdown">
                    <li><a href="cart.html">购物车</a></li>
                    <li><a href="payment-info.html">支付信息</a></li>
                    <li><a href="dash-items.html">我的订单</a></li>
                </ul>
            </li>
            <li><a href="login-register.html" class="ui-btn ui-btn-info" id="username">Get Started</a></li>
        </ul>
        <i class="nav-toggle fa fa-bars"></i>
    </nav>
    <!--导航栏结束-->


    <button id="btn" class="ui-btn ui-btn-info form-control addCate">加入购物车</button>
    <!--item-->
    <div class="detail-wrapper" id="itemDetails">
        <!--item aside details-->
        <div class="item-detail-aside">
            <div class="listed-by">
                <strong>出售人:</strong>
                <div class="lister">
                    <img src="img/lister.jpg" alt="">
                </div>
            </div>
            <div class="lister-info">
                <strong>王姐</strong>
                <hr>
                <span><i class="fa fa-phone ui-text-warn"></i> <em>1366566666</em></span>
                <span><i class="fa fa-map-marker ui-text-success"></i> <em>河南郑州</em></span>
                <span><i class="fa fa-globe ui-text-info"></i> <a href="#">www.shenglong.com</a></span>
                <span><i class="fa fa-envelope-o ui-text-danger"></i> <a
                        href="mailto:megan@example.com">wsw7537@163.com</a></span>
                <hr>
            </div>

            <div class="contact-lister">

                
            </div>
        </div>
        <!--end item aside details-->

    </div>
    <!--end item-->

    <!--page loader-->
    <div class="page-loader">
        <div class="loader"><img src="img/logo.png" alt=""></div>
    </div>
    <!--end page loader-->

    <!--footer section-->
    <footer class="footer">
        <div class="footer-item">
            <strong>联系我们</strong>
            <a href="#"><i class="fa fa-angle-right"></i> 刊登广告</a>
            <a href="#"><i class="fa fa-angle-right"></i> 社区论坛</a>
            <a href="#"><i class="fa fa-angle-right"></i> 联盟计划</a>
        </div>
        <div class="footer-item">
            <strong>帮助中心</strong>
            <a href="#"><i class="fa fa-angle-right"></i> 账户管理</a>
            <a href="#"><i class="fa fa-angle-right"></i> 购物指南</a>
            <a href="#"><i class="fa fa-angle-right"></i> 订单操作</a>
        </div>
        <div class="footer-item">
            <strong>关注我们</strong>
            <a href="#"><i class="fa fa-angle-right"></i> 新浪微博</a>
            <a href="#"><i class="fa fa-angle-right"></i> 官方微信</a>
            <a href="#"><i class="fa fa-angle-right"></i> 联系我们</a>
        </div>
        <div class="footer-item">
            <strong>服务支持</strong>
            <a href="#"><i class="fa fa-angle-right"></i> 售后政策</a>
            <a href="#"><i class="fa fa-angle-right"></i> 自助服务</a>
            <a href="#"><i class="fa fa-angle-right"></i> 相关下载</a>
        </div>
    </footer>
    <div class="bottom-strip">
        <div class="cards-accepted">
            <img src="img/card-logos.png" alt="">
        </div>
        <div class="copyright"><i class="fa fa-copyright"></i> <span>升龙. 想你所想</span></div>
        <div class="country"><span>中国</span><img src="img/flag.jpg" alt=""></div>
    </div>
    <!--end footer section-->

    <!--page loader-->
    <div class="page-loader">
        <div class="loader"><img src="img/logo.png" alt=""></div>
    </div>
    <!--end page loader-->

    <!--scripts-->
    <script src="vendor/js/jquery-3.2.1.min.js"></script>
    <script src="vendor/js/popper.js"></script>
    <!-- <script src="vendor/js/bootstrap.min.js"></script> -->
    <script src="vendor/js/alertify.js"></script>
    <script src="vendor/js/jquery.knob.min.js"></script>
    <!--[if IE]><script type="text/javascript" src="vendor/js/excanvas.js"></script><![endif]-->
    <script src="vendor/js/summernote-bs4.min.js"></script>
    <script src="vendor/js/dropzone.js"></script>
    <script src="vendor/OwlCarousel2-2.2.1/owl.carousel.min.js"></script>
    <script src="vendor/perfect-scrollbar/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="vendor/js/typed.js"></script>
    <script src="js/app.js"></script>
    <script src="js/axios.min.js"></script>
    <!--end scripts-->

</body>

</html>
<script>
    let detailId = location.search.slice(1);
    console.log(location)
    let inner = document.getElementById("itemDetails");
    let token = sessionStorage.getItem("token");
    if(sessionStorage.getItem("token")){
        $("#username").html(sessionStorage.getItem("nickName"))
    }
    function getDetail() {
        $.ajax({
            type: "get",
            url: "http://localhost:3009/api/v1/products/" + detailId,
            async: true,
            success: function (data) {
                let html = `<div class="item-details">
        <img src="http://localhost:3009${data.coverImg}" alt="">
        <div class="title-price">
            <strong class="titlet">${data.name}</strong>
            <span>价格: <strong class="price">￥${data.price}</strong></span>
        </div>

        <div class="item-status">
            <div class="status-box">
                <strong>购于</strong>
                <span>2018年6月</span>
            </div>
            <div class="status-box">
                <strong>是否</strong>
                <span>可用</span>
            </div>
            <div class="status-box">
                <strong>地址</strong>
                <span><i class="fa fa-map-marker"></i> 河南郑州</span>
            </div>
            <div class="status-box">
                <strong>颜色</strong>
                <span>黑白色</span>
            </div>
            <div class="status-box">
                <strong>型号</strong>
                <span>WG-6Y7</span>
            </div>
        </div>

        <p class="description">
            <strong>出售原因以及商品信息</strong>
            ${data.descriptions}
        </p>

        <div class="owner-msg">
            <strong>卖家留言</strong>
            <p>
                <i class="fa fa-quote-left ui-text-success"></i>
                <span>
                    您好，谢谢您浏览我的物品。如果您有兴趣购买这个${data.name}，请使用表格保留我的姓名，我会尽快与您联系！
                </span>
                <i class="fa fa-quote-right ui-text-success"></i>
            </p>
        </div>

        <div class="share-item">
            <strong>分享</strong>
            <div>
                <a href="#"><strong>微博</strong> <i class="fa fa-twitter"></i></a>
                <a href="#"><strong>微信</strong> <i class="fa fa-facebook-f"></i></a>
                <a href="#"><strong>QQ</strong> <i class="fa fa-google-plus"></i></a>
            </div>
        </div>
    </div>`;
                inner.innerHTML += html;
                sessionStorage.setItem("product", JSON.stringify(data));
            }
        });
    }
    getDetail();
    $(".addCate").click(() => {
        console.log("ok");
        addCar(JSON.parse(sessionStorage.getItem("product")));
    });
    function addCar(product) {
        let dataItems = JSON.parse(sessionStorage.getItem("product"));
        axios.post("http://localhost:3009/api/v1/shop_carts", {
            product:dataItems._id,
            quantity:1
        }, { headers: { authorization: "Bearer " + token } }).then((res) => {
            console.log(res)
            if(res.status==200){
                alert("加入购物车成功")
            }
        }).catch();
    }
</script>